/* MIXINS */

@mixin transition($property, $duration, $ease, $delay){
    -webkit-transition: $property $duration $ease $delay;
    -moz-transition: $property $duration $ease $delay;
    -o-transition: $property $duration $ease $delay;
    transition: $property $duration $ease $delay;
}

@mixin gradient($light, $dark){
	background: $dark; /* Old browsers */
	background: -moz-linear-gradient(top, $light 30%, $dark 99%) !important; /* FF3.6-15 */
	background: -webkit-linear-gradient(top, $light 30%,$dark 99%) !important; /* Chrome10-25,Safari5.1-6 */
	background: linear-gradient(to bottom, $light 30%,$dark 99%) !important; /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
}

@mixin transform($property){
	-moz-transform: $property;
	-webkit-transform: $property;
	-o-transform: $property;
	-ms-transform: $property;
	transform: $property;
}

.train{
	.poke{
		display:block;
		width:100%;

		&:first-of-type{
			float:left;
		}

		&:last-of-type{
			float:right;
		}

		&.ai-options{
			float:right;
		}

		h3:first-of-type{
			margin:0;
		}

		.options{
			display:none;
		}

		.custom-options,
		.poke-stats{
			display:block;
		}

		.poke.multi{
			float:none;
			display:none;

			.poke-stats{
				background:none;
				padding:0;
			}
		}
	}
}

.section.battle{
	text-align: center;
}

.battle-active{
	.battle-window{
		display:inline-block;
	}
	header{
		display: none;
	}
}

.battle-window{
	display:none;
	background:rgba(255,255,255,0.75);
	margin:0 auto;
	overflow: hidden;
	position:relative;
    box-shadow: 0px 5px 15px;
	cursor:pointer;
	touch-action: manipulation;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    -moz-tap-highlight-color: rgba(0, 0, 0, 0);
  	-webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome and Opera */

	.img-block{
		visibility: hidden;
		max-width:100%;
	}

	.top{
		padding-top:10px;
		text-align:center;
		position:absolute;
		width:100%;
		top:0;
		z-index:10;

		.timer{
			display:none;
			color:#eee;
			width:60px;
			height:60px;
			border-radius:60px;
			background:rgba(0,0,0,0.75);
			margin: 0 auto;

			.text{
				display:table-cell;
				vertical-align: middle;
				font-size:28px;
			}
		}

		.shields{
			position:absolute;
			top: 55px;
			background-size:contain;
			background-image:url('../img/shield.png');
			background-repeat:no-repeat;
			padding-left:24px;

			&.left{
				left:6%;
			}

			&.right{
				right:6%;
			}

			&.no-shields{
				color:#ff0000;
			}
		}

		.team-indicator{
			position:absolute;
			background:rgba(0,0,0,0.75);
			border-radius:40px;
			display:flex;
			top:25px;
			padding: 0 5px;

			&.left{
				left:5%;
			}

			&.right{
				right:5%;
			}

			.ball{
				width:20px;
				height:20px;
				border-radius:40px;
				background:#ff0000;
				margin: 3px 4px;

				&.fainted{
					background:#000;
				}
			}
		}
	}

	.scene{
		position:absolute;
		width: 150%;
		height: 150%;
		left: -25%;
		top: -25%;

		@include transition(all, 0.5s, ease, 0s);

		.background{
			position: absolute;
			top:0;
			left:0;
			width:100%;
			height:100%;
			background-image: url('../img/train/pvp-bg.jpg');
			background-repeat: no-repeat;
			background-position: center bottom;
		}

		.pokemon-container{
			position:absolute;
			width:37.5%;

			&.self{
				bottom: 30%;
				left: 20%;

				.pokemon{
					@include transform(scaleX(-1));
					
					.main-sprite, .secondary-sprite{
						z-index:10;
					}
				}
			}

			&.opponent{
				bottom: 55%;
				right: 25%;
				
				.shield-sprite{
					z-index:20;
				}
			}

			h3{
				display: inline-block;
			    padding: 5px;
			    margin: 0 0 5px 0;
			    border-radius: 12px;
				text-align: center;

			}

			.messages{
				text-align: center;
			}

			.pokemon{
				@include transition(all, 1s, ease, 0s);

				position:relative;
				width:100px;
				height:100px;
				margin: 0 auto;
				
				.shadow{
					width:151px;
					height:62px;
					background:url('../img/train/sprite-shadow.png');
					background-size:100%;
					background-repeat: no-repeat;
					position: absolute;
					z-index: 5;
					top: 65px;
					left: -25px;
					opacity: 0.45;
				}
				
				.shield-sprite-container{
					position:absolute;
					top:0;
					left:0;
					
					&.active{
						.shield-sprite{
							opacity:.85;
						}
					}
					
					.shield-sprite{
						width:65px;
						height:55px;
						background:url('../img/train/shield.png');
						background-size:cover;
						background-repeat: no-repeat;
						position:absolute;
						opacity:0;
						
						&:nth-of-type(1){
							@include transition(all, .75s, ease, 0s);
							top:-15px;
						}
						&:nth-of-type(2){
							@include transition(all, .75s, ease, .05s);
							top: 15px;
							left: 52px;
						}
						&:nth-of-type(3){
							@include transition(all, .75s, ease, .15s);
							top: 45px;
						}
						&:nth-of-type(4){
							@include transition(all, .75s, ease, .2s);
							top: 15px;
						    left: -52px;
						}
					}
				}
			}

			.hp.bar-back{
				border:2px solid #666;
				height:20px;
				width: 90%;
				margin: 0 auto 20px auto;

				.bar{
					position:relative;
					top:-12px;

					&.damage{
						background:#ff5115;
						position: relative;
						top: 0px;

						@include transition(width, 0.2s, ease, 0.5s);
					}
					
					&[color="yellow"]{
						background:#eabd49;
					}
					
					&[color="red"]{
						background:#ea4949;
					}
				}
			}
		}
	}

	.controls{
		position:absolute;
		bottom:0;
		width:100%;
		height:40%;

		@include gradient(rgba(0,0,0,0), rgba(0,0,0,.85));

		.move-bars{
			position:absolute;
			bottom:35%;
			width:100%;

			.move-bar{
				display:block;
				width:70px;
				height:70px;

				@include transition(all, 0.2s, ease, 0s);

				.label{
					font-size:24px;
					padding-top:18px;
					pointer-events: none;
				}

				&.active{
					border:3px solid #000;
					box-shadow: 0px 5px 10px rgba(0,0,0,.5);

					@include transform(scale(1.25, 1.25));


					&:active{
						@include transform(scale(1.15, 1.15));
					}
				}
			}
		}

		.switch-btn{

			width:40px;
			height:35px;
			border-radius:40px;
			background:rgba(0,0,0,0.5);
			border:2px solid #000;
			text-align:center;
			padding-top:5px;
			font-size:24px;
			font-weight:bold;
			position:absolute;
			z-index: 25;
			bottom:5%;
			right:5%;
			-webkit-text-fill-color: #eee;
			-webkit-text-stroke-width: 1px;
			-webkit-text-stroke-color: #000;

			&.active{
				background:#eee;
			}
		}
	}

	.shield-window{
		width:100%;
		height:40%;
		position:absolute;
		left:0;
		bottom:0;
		opacity: 0;
		pointer-events: none;

		@include transition(all, 0.25s, ease, 0s);

		&.closed{
			pointer-events: none;
			bottom:-50%;
		}

		.container{

			.close{
				font-weight: bold;
				text-transform: uppercase;
				cursor:pointer;
			}

			.shield{
				width:109px;
				height:94px;
				margin: 1em auto;
				cursor:pointer;
				background:url('../img/train/shield.png');
				background-size:contain;
			}
		}
	}

	.shield-window, .switch-window, .charge-window{
		position:absolute;
		height:50%;
		bottom:0;
		width:100%;
		text-align: center;
		color:#eee;
		opacity: 0;
		pointer-events: none;
	}

	.shield-window .container,
	.switch-window .container{
		width:90%;
		margin:0 auto;
		height:100%;
		border-radius:12px;
		background:rgba(0,0,0,0.5);
		color:#eee;
		text-align: center;
		padding:30px;
		box-sizing:border-box;
	}

	.charge-window{

		@include transition(all, 0.25s, ease, 0.25s);

		.container{

			p{
				padding:10px;
				border-radius:8px;
				background:rgba(0,0,0,0.5);
			}

			.move-bar{
				display:block;
				width:120px;
				height:120px;
				border-radius:120px;
				border: 6px solid #eee;

				.label{
					font-size:60px;
					padding-top:22px;
				}
			}
		}

		.rings{
			position:absolute;
			width:500px;
			height:500px;
			left:50%;
			bottom:-25%;
			margin-left:-250px;

			.ring-container{
				position:absolute;
				width: 100%;
				height: 100%;
				display: flex;
				justify-content: center;
				align-items: center;

				.ring{
					border: 4px solid #eee;
					border-radius: 500px;
				}
			}

			.ring-container:nth-of-type(1) .ring{
				max-width:90%;
				max-height:90%;
			}

			.ring-container:nth-of-type(2) .ring{
				max-width:95%;
				max-height:95%;
			}

			.ring-container:nth-of-type(3) .ring{
				max-width:100%;
				max-height:100%;
			}
		}
	}

	.switch-window{
		height:30%;
		opacity:1;
		text-align: center;
		z-index:20;
		bottom:-30%;

		@include transition(all, 0.25s, ease, 0s);

		&.active{
			bottom:0;
			pointer-events: all;
		}

		p{
			margin-top:0;
		}

		.container{
			padding: 15px 30px;
		}
	}

	.animate-message{
		position: absolute;
		width: 100%;
		text-align: center;
		top: 37%;
		opacity:0;
		pointer-events: none;
		z-index:25;

		@include transition(all, 0.25s, ease, 0.25s);

		.text{
			margin: 0 auto;
			display: inline-block;
			background: rgba(0,0,0,0.65);
			color: #eee;
			padding: 10px;
			border-radius: 12px;
			font-size: 18px;
		}
	}

	.countdown{
		width:100%;
		height:100%;
		position:absolute;
		z-index:20;
		top:0;
		left:0;
		display:none;
		justify-content: center;
		align-items: center;
		pointer-events: none;

		.text{
			font-size:300px;
			font-weight:bold;
			text-transform: uppercase;
			color:#eee;

		}

		&.animate .text{
			font-size:72px;
			@include transition(all, 0.9s, ease, 0s);
		}
	}

	// Phases

	&[phase="suspend_charged_shield"]{
		.timer{
			display:table;
		}

		.shield-window{
			opacity: 1;
			pointer-events: all;
		}

		.controls .move-bars{
			display:none;
		}

		.scene{
			@include transform(scale(0.8));
		}
	}
	
	&[phase="suspend_charged_no_shields"]{
		.animate-message{
			opacity:1;
		}
		
		.controls .move-bars{
			display:none;
		}
		
		.scene{
			@include transform(scale(0.8));
		}
	}

	&[phase="suspend_charged_attack"]{
		.timer{
			display:table;
		}

		.animate-message{
			opacity:1;
		}

		.charge-window{
			opacity: 1;
			pointer-events: all;
		}

		.controls .move-bars{
			display:none;
		}

		.scene{
			@include transform(scale(1.1));
		}
	}

	&[phase="suspend_switch_self"]{
		.timer{
			display:table;
		}

		.switch-window{
			bottom:0;
			pointer-events: all;
		}
	}

	&[phase="suspend_switch"]{
		.animate-message{
			opacity:1;
		}
	}

	&[phase="animating"]{
		.animate-message{
			opacity:1;
		}
	}

	&[phase="countdown"]{
		.top, .controls{
			display:none;
		}

		.countdown{
			display:flex;
		}
	}

	&[phase="game_over_screen"]{
		display:inline-block;

		.end-screen-container{
			bottom:-10px;
		}
	}

}

.team-select .pokemon-container,
.switch-window .pokemon-container{
	display:flex;
	justify-content:space-around;

	.sprite-container{
		opacity:0.25;
		overflow:hidden;
	}

	.name{
		padding:5px;
		border-radius:12px;
		margin-top:5px;
		max-width:100px;
		font-weight:bold;
	}
	
	.name, .cp{
		text-align:center;
	}

	.pokemon.active .sprite-container{
		opacity:1;
	}
}

.team-select{
	display:none;
	
	.pokemon-container{
		justify-content: space-between;
		flex-wrap: wrap;
		
		.pokemon{
			width:100px;
			margin-bottom:10px;
			
			.number{
				width:100%;
				height:100%;
				position:absolute;
				top:0;
				left:0;
				background:#0088a6;
				color:#eee;
				font-weight: bold;
				display:none;
			}
			
			&.selected{
				.number{
					display:block;
					opacity: 0.9;
					font-size: 40px;
					text-align: center;
					padding-top: 5px;
				}
			}
		}
	}
	
	.self, .opponent{
		background:rgba(255,255,255,0.75);
		border-radius:12px;
		padding: 10px 0;
		
		h3{
			margin-top:0;
		}
		
		.pokemon{
			cursor:pointer;
		}
	}
	
	.lets-go-btn{
		display:none;
	}
}

/* END SCREEN */

.end-screen-container{
	@include transition(all, 0.5s, ease, 0s);

	position:absolute;
	z-index:50;
	width:100%;
	bottom:-100%;

	.end-screen{
		width:90%;
		margin: 0 auto;
		padding-bottom: 20px;
		min-height:450px;
		box-shadow: #000 0px 0px 15px;
		background: rgba(255,255,255,.95);

		h3:first-of-type{
			margin-top:0;
		}
	}

	.pokemon-entry{
		display:flex;
		margin-bottom:15px;

		.name{
			text-align: left;
			font-size:12px;
		}

		.poke-icon{
			width:25%;
		}

		.damage-container{
			width:75%;

			.damage-bar{
				width:100%;
				height:12px;
				border-radius:12px;
				background:#000;
			}
		}
	}
}

/* POKEMON SPRITES */
.sprite-container{
	width:36px;
	height:36px;
	border:1px solid #0088a6;
	border-radius:12px;
	padding:10px;
	background:#333;
	margin: 0 auto;
	position:relative;
}

.main-sprite,
.secondary-sprite,
.white-sprite{
	position:absolute;
	top:0;
	left:0;
	width:100%;
	height:100%;
	background-size:600% 300%;
}

.main-sprite{
	background-image:url('../img/train/substitute-sprite-main.png');
}

.secondary-sprite{
	background-image:url('../img/train/substitute-sprite-secondary.png');
}

.white-sprite{
	@include transition(opacity, .75s, ease, 0s);
	background-image:url('../img/train/substitute-sprite-white.png');
	background-size:100%;
	background-repeat: no-repeat;
	opacity:0;
	z-index:25;
}

.pokemon[type-1="bug"] .main-sprite,
.pokemon[type-2="bug"] .secondary-sprite{
	background-position: 0 0;
}

.pokemon[type-1="dark"] .main-sprite,
.pokemon[type-2="dark"] .secondary-sprite{
	background-position: -100% 0;
}

.pokemon[type-1="dragon"] .main-sprite,
.pokemon[type-2="dragon"] .secondary-sprite{
	background-position: -200% 0;
}

.pokemon[type-1="electric"] .main-sprite,
.pokemon[type-2="electric"] .secondary-sprite{
	background-position: -300% 0;
}

.pokemon[type-1="fairy"] .main-sprite,
.pokemon[type-2="fairy"] .secondary-sprite{
	background-position: -400% 0;
}

.pokemon[type-1="fighting"] .main-sprite,
.pokemon[type-2="fighting"] .secondary-sprite{
	background-position: -500% 0;
}

.pokemon[type-1="fire"] .main-sprite,
.pokemon[type-2="fire"] .secondary-sprite{
	background-position: 0% -100%;
}

.pokemon[type-1="flying"] .main-sprite,
.pokemon[type-2="flying"] .secondary-sprite{
	background-position: -100% -100%;
}

.pokemon[type-1="ghost"] .main-sprite,
.pokemon[type-2="ghost"] .secondary-sprite{
	background-position: -200% -100%;
}

.pokemon[type-1="grass"] .main-sprite,
.pokemon[type-2="grass"] .secondary-sprite{
	background-position: -300% -100%;
}

.pokemon[type-1="ground"] .main-sprite,
.pokemon[type-2="ground"] .secondary-sprite{
	background-position: -400% -100%;
}

.pokemon[type-1="ice"] .main-sprite,
.pokemon[type-2="ice"] .secondary-sprite{
	background-position: -500% -100%;
}

.pokemon[type-1="normal"] .main-sprite,
.pokemon[type-2="normal"] .secondary-sprite{
	background-position: 0% -200%;
}

.pokemon[type-1="poison"] .main-sprite,
.pokemon[type-2="poison"] .secondary-sprite{
	background-position: -100% -200%;
}

.pokemon[type-1="psychic"] .main-sprite,
.pokemon[type-2="psychic"] .secondary-sprite{
	background-position: -200% -200%;
}

.pokemon[type-1="rock"] .main-sprite,
.pokemon[type-2="rock"] .secondary-sprite{
	background-position: -300% -200%;
}

.pokemon[type-1="steel"] .main-sprite,
.pokemon[type-2="steel"] .secondary-sprite{
	background-position: -400% -200%;
}

.pokemon[type-1="water"] .main-sprite,
.pokemon[type-2="water"] .secondary-sprite{
	background-position: -500% -200%;
}

/* ANIMATIONS */

.battle-window .scene .pokemon-container{

	&[cooldown="500"]{
		@include transition(all, 0.25s, ease-out, 0s);
	}

	&[cooldown="1000"]{
		@include transition(all, 0.75s, ease-out, 0s);
	}

	&[cooldown="1500"]{
		@include transition(all, 1.25s, ease-out, 0s);
	}

	&[cooldown="2000"]{
		@include transition(all, 1.75s, ease-out, 0s);
	}

	&[cooldown="2500"]{
		@include transition(all, 2.25s, ease-out, 0s);
	}

	&.animate-fast{
		@include transition(all, 0.25s, ease-out, 0s);

		&.self{
			bottom:31%;
			left:21%;
		}

		&.opponent{
			bottom:54%;
			right:26%;
		}
	}

	&.animate-switch{
		.pokemon{
			@include transform(scale(0, 0));
			
			.white-sprite{
				opacity: 1;
			}
			
			.shadow{
				display:none;
			}
		}

		.hp, .name, .messages{
			display:none;
		}
	}

}

@media only screen and (max-width: 720px) {
	.train .poke{
		width:49%;
	}
}
